<div class="product-list-container">
  <div class="header">
    <h2>Products</h2>
    <button mat-raised-button color="primary" routerLink="/products/new">
      <mat-icon>add</mat-icon> Add Product
    </button>
  </div>
  
  <!-- Loading spinner -->
  <div class="loading-container" *ngIf="isLoading">
    <mat-spinner></mat-spinner>
    <p>Loading products...</p>
  </div>
  
  <!-- Error message -->
  <div class="error-container" *ngIf="errorMessage && !isLoading">
    <mat-card class="error-card">
      <mat-card-content>
        <mat-icon class="error-icon">error</mat-icon>
        <p>{{ errorMessage }}</p>
        <button mat-button color="primary" (click)="loadProducts()">Retry</button>
      </mat-card-content>
    </mat-card>
  </div>
  
  <!-- No products message -->
  <div class="no-products-container" *ngIf="!isLoading && products.length === 0 && !errorMessage">
    <mat-card class="no-products-card">
      <mat-card-content>
        <div class="no-products">
          <mat-icon>inventory_2</mat-icon>
          <h3>No Products Found</h3>
          <p>Get started by adding your first product!</p>
          <button mat-raised-button color="primary" routerLink="/products/new">
            <mat-icon>add</mat-icon> Add Product
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
  
  <!-- Product grid -->
  <div class="product-grid" *ngIf="!isLoading && products.length > 0">
    <mat-card class="product-card" *ngFor="let product of products; trackBy: trackByProductId">
      <div class="product-image-container">
        <!-- Product image or placeholder -->
        <img 
          *ngIf="getFirstImage(product)" 
          [src]="getFirstImage(product)" 
          [alt]="product.name"
          class="product-image"
          (error)="onImageError($event)">
        
        <!-- Placeholder when no image -->
        <div *ngIf="!getFirstImage(product)" class="image-placeholder">
          <mat-icon>image</mat-icon>
          <span>No Image</span>
        </div>
      </div>
      
      <mat-card-header>
        <mat-card-title class="product-title">{{ product.name }}</mat-card-title>
        <mat-card-subtitle class="product-price">
          {{ formatPrice(product.basePrice) }}
        </mat-card-subtitle>
      </mat-card-header>
      
      <mat-card-content>
        <p class="product-description">
          {{ getTruncatedDescription(product.description) }}
        </p>
        
        <div class="product-info">
          <div class="stock-info">
            <mat-icon>inventory</mat-icon>
            <span>Stock: {{ product.stock }}</span>
          </div>
          
          <div class="category-info">
            <mat-icon>category</mat-icon>
            <span>{{ product.category }}</span>
          </div>
          
          <div class="status-info" [class.active]="product.isActive">
            <mat-icon>{{ product.isActive ? 'check_circle' : 'cancel' }}</mat-icon>
            <span>{{ product.isActive ? 'Active' : 'Inactive' }}</span>
          </div>
        </div>
        
        <!-- Sizes display using chips -->
        <div class="sizes-section">
          <h4>Available Sizes</h4>
          @if (getSizeChips(product).length > 0) {
            <mat-chip-listbox>
              @for (size of getSizeChips(product); track size) {
                <mat-chip-option>{{ size }}</mat-chip-option>
              }
            </mat-chip-listbox>
          } @else {
            <p class="no-sizes">No sizes available</p>
          }
        </div>
      </mat-card-content>
      
      <mat-card-actions>
        <button mat-button color="primary" [routerLink]="['/products', product.id, 'edit']">
          <mat-icon>edit</mat-icon> Edit
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>